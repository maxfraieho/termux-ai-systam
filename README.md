# AI Service - Embeddings —Ç–∞ –ì–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞ –ú–æ–¥–µ–ª—å

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ AI –º–æ–¥–µ–ª—è–º–∏ –Ω–∞ Android –≤ Termux:
- Ukrainian MPNet Embeddings (Q8_0 —Ç–∞ F16)
- Gemma 3N –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞ –º–æ–¥–µ–ª—å
- HTTP API –¥–ª—è –µ–º–±–µ–¥–¥–∏–Ω–≥—ñ–≤
- –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –ª–∞—É–Ω—á–µ—Ä

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –º–æ–¥–µ–ª—ñ

### Ukrainian MPNet Embeddings
- **Q8_0** (290MB) - —à–≤–∏–¥–∫—ñ –µ–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —Ç–µ–∫—Å—Ç—ñ–≤
- **F16** (538MB) - —Ç–æ—á–Ω—ñ –µ–º–±–µ–¥–¥–∏–Ω–≥–∏ –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —Ç–µ–∫—Å—Ç—ñ–≤
- –†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å: 768
- –ú–æ–¥–µ–ª—å: `ukr-paraphrase-multilingual-mpnet-base`

### Gemma 3N
- **Gemma 3N Q4_K_M** (1.1GB) - –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è —á–∞—Ç—É
- –ö–≤–∞–Ω—Ç–∏–∑–∞—Ü—ñ—è: Q4_K_M (–æ–ø—Ç–∏–º–∞–ª—å–Ω–∏–π –±–∞–ª–∞–Ω—Å —Ä–æ–∑–º—ñ—Ä—É —Ç–∞ —è–∫–æ—Å—Ç—ñ)

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ Embedding —Å–µ—Ä–≤—ñ—Å—É

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å (Q8_0 –≤–∞—Ä—ñ–∞–Ω—Ç)
./start_embedding_service.sh start

# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑ F16 –≤–∞—Ä—ñ–∞–Ω—Ç–æ–º
VARIANT=F16 ./start_embedding_service.sh start

# –ó—É–ø–∏–Ω–∏—Ç–∏ —Å–µ—Ä–≤—ñ—Å
./start_embedding_service.sh stop

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
./start_embedding_service.sh restart

# –°—Ç–∞—Ç—É—Å
./start_embedding_service.sh status
```

### 2. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è Embeddings

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
./test_embedding_uk.sh
```

### 3. AI –õ–∞—É–Ω—á–µ—Ä (—ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –º–µ–Ω—é)

```bash
./ai_launcher.sh
```

–ú–µ–Ω—é –æ–ø—Ü—ñ–π:
1. Gemma 3N - –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–∏–π —á–∞—Ç
2. Ukrainian MPNet Q8 - —à–≤–∏–¥–∫—ñ –µ–º–±–µ–¥–¥–∏–Ω–≥–∏
3. Ukrainian MPNet F16 - —Ç–æ—á–Ω—ñ –µ–º–±–µ–¥–¥–∏–Ω–≥–∏
4. –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –µ–º–±–µ–¥–¥–∏–Ω–≥—ñ–≤
5. –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ CPU
6. –ü–µ—Ä–µ–≥–ª—è–¥ –ª–æ–≥—ñ–≤

### 4. MD to Embeddings Service

```bash
# –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Ä–µ–∂–∏–º
python3 md_to_embeddings_service_v4.py
```

–§—É–Ω–∫—Ü—ñ—ó:
- –†–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—É –ø—Ä–æ—î–∫—Ç—É
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü—ñ—è DRAKON —Å—Ö–µ–º (`.json ‚Üí .md`)
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —É–∑–∞–≥–∞–ª—å–Ω—é—é—á–æ–≥–æ `.md` –∑ –∫–æ–¥—É –ø—Ä–æ—î–∫—Ç—É
- –ö–æ–ø—ñ—é–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—ñ–≤ –¥–æ Dropbox

## üì° HTTP API

### Health Check
```bash
curl http://127.0.0.1:8765/health
```

–í—ñ–¥–ø–æ–≤—ñ–¥—å:
```json
{"status": "healthy", "model": "lang-uk-mpnet-Q8.gguf"}
```

### –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è Embedding
```bash
curl -X POST http://127.0.0.1:8765/embed \
  -H "Content-Type: application/json" \
  -d '{"text":"–ö–∏—ó–≤ ‚Äî —Å—Ç–æ–ª–∏—Ü—è –£–∫—Ä–∞—ó–Ω–∏."}'
```

–í—ñ–¥–ø–æ–≤—ñ–¥—å:
```json
{
  "embedding": [0.145, 0.015, 0.707, ...],
  "dim": 768,
  "model": "lang-uk-mpnet-Q8.gguf"
}
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª—ñ–≤

```
ai_service/
‚îú‚îÄ‚îÄ README_AI_SERVICE.md          # –¶–µ–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ README.md                      # –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π README
‚îú‚îÄ‚îÄ SUMMARY.md                     # –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è
‚îú‚îÄ‚îÄ AI_INTEGRATION_SUMMARY.txt    # –ó–≤—ñ—Ç –ø—Ä–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é
‚îÇ
‚îú‚îÄ‚îÄ md_to_embeddings_service_v4.py  # –û—Å–Ω–æ–≤–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –æ–±—Ä–æ–±–∫–∏ MD
‚îÇ
‚îú‚îÄ‚îÄ ai_launcher.sh                 # –ì–æ–ª–æ–≤–Ω–∏–π —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –ª–∞—É–Ω—á–µ—Ä
‚îú‚îÄ‚îÄ install_embeddings.sh          # –Ü–Ω—Å—Ç–∞–ª—è—Ü—ñ—è Ukrainian MPNet
‚îú‚îÄ‚îÄ start_embedding_service.sh     # –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞ –µ–º–±–µ–¥–¥–∏–Ω–≥—ñ–≤
‚îú‚îÄ‚îÄ start_gemma_service.sh         # –ó–∞–ø—É—Å–∫ Gemma –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω–æ—ó –º–æ–¥–µ–ª—ñ
‚îú‚îÄ‚îÄ run_md_service.sh              # –î–æ–ø–æ–º—ñ–∂–Ω–∏–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫—É
‚îî‚îÄ‚îÄ test_embedding_uk.sh           # –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏—Ö —Ç–µ–∫—Å—Ç—ñ–≤
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è

### Embedding Service

- **–ü–æ—Ä—Ç**: 8765 (–∑–º—ñ–Ω–∏—Ç–∏: `PORT=8080 ./start_embedding_service.sh start`)
- **–•–æ—Å—Ç**: 127.0.0.1 (–ª–æ–∫–∞–ª—å–Ω–∏–π –¥–æ—Å—Ç—É–ø)
- **–ü–æ—Ç–æ–∫–∏**: 6 CPU threads
- **CPU Affinity**: 0-6
- **–ú–æ–¥–µ–ª—å**: Q8 –∞–±–æ F16 (–∑–º—ñ–Ω–∏—Ç–∏: `VARIANT=F16`)

### –ú–æ–¥–µ–ª—ñ

–ú–æ–¥–µ–ª—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤:
- `~/.local/opt/gguf/embeddings/` - Ukrainian MPNet –º–æ–¥–µ–ª—ñ
- `~/models/` - –£—Å—ñ –º–æ–¥–µ–ª—ñ —Ç–∞ –ª–æ–≥–∏
- `~/models/ukr-mpnet/` - –õ–æ–≥–∏ —Ç–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—ñ–≤
- `~/models/gemma3n/` - Gemma –º–æ–¥–µ–ª—å

## üß™ –ü—Ä–∏–∫–ª–∞–¥–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### Python

```python
import requests

# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –µ–º–±–µ–¥–¥–∏–Ω–≥—É
response = requests.post('http://127.0.0.1:8765/embed',
    json={'text': '–®—Ç—É—á–Ω–∏–π —ñ–Ω—Ç–µ–ª–µ–∫—Ç –≤ –£–∫—Ä–∞—ó–Ω—ñ'})

embedding = response.json()['embedding']
dimension = response.json()['dim']

print(f"–†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å: {dimension}")
print(f"–ü–µ—Ä—à—ñ 5 –∑–Ω–∞—á–µ–Ω—å: {embedding[:5]}")
```

### Bash

```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ –µ–º–±–µ–¥–¥–∏–Ω–≥
TEXT="–ú–∞—à–∏–Ω–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è"
curl -s -X POST http://127.0.0.1:8765/embed \
  -H "Content-Type: application/json" \
  -d "{\"text\":\"$TEXT\"}" | jq '.embedding[0:5]'
```

### JavaScript (Node.js)

```javascript
const response = await fetch('http://127.0.0.1:8765/embed', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({ text: '–ö–∏—ó–≤—Å—å–∫–∏–π –ø–æ–ª—ñ—Ç–µ—Ö–Ω—ñ—á–Ω–∏–π —ñ–Ω—Å—Ç–∏—Ç—É—Ç' })
});

const data = await response.json();
console.log('Dimension:', data.dim);
console.log('Embedding:', data.embedding.slice(0, 5));
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è

### Embedding —Ç–µ—Å—Ç–∏

```
‚úì –¢–µ—Å—Ç 1: –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç
  –†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å: 768
  –ü–µ—Ä—à—ñ 3 –∑–Ω–∞—á–µ–Ω–Ω—è: [0.145, 0.015, 0.707]

‚úì –¢–µ—Å—Ç 2: –°–µ—Ä–µ–¥–Ω—ñ–π —Ç–µ–∫—Å—Ç
  –†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å: 768

‚úì –¢–µ—Å—Ç 3: –°–µ–º–∞–Ω—Ç–∏—á–Ω–∞ –ø–æ–¥—ñ–±–Ω—ñ—Å—Ç—å
  Cosine similarity: 0.7516
  ‚úì –ü–æ–¥—ñ–±–Ω—ñ —Ç–µ–∫—Å—Ç–∏ –º–∞—é—Ç—å –≤–∏—Å–æ–∫—É —Å—Ö–æ–∂—ñ—Å—Ç—å
```

–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤: `~/models/ukr-mpnet/test_outputs/`

## üîß Troubleshooting

### –°–µ—Ä–≤—ñ—Å –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ –ø–æ—Ä—Ç –≤—ñ–ª—å–Ω–∏–π
netstat -tlnp | grep 8765

# –ü–æ–¥–∏–≤–∏—Ç–∏—Å—è –ª–æ–≥–∏
tail -f ~/models/ukr-mpnet/service.log

# –í–±–∏—Ç–∏ –ø—Ä–æ—Ü–µ—Å —è–∫—â–æ –∑–∞–≤–∏—Å
pkill -f llama-embedding-server
```

### –ú–æ–¥–µ–ª—å –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞

```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ symlinks
ls -lh ~/.local/opt/gguf/embeddings/

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Ñ–∞–π–ª–∏
ls -lh ~/models/embeddings/*.gguf

# –ü–µ—Ä–µ—ñ–Ω—Å—Ç–∞–ª—é–≤–∞—Ç–∏ (—è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ)
./install_embeddings.sh
```

### –ü–æ–≤—ñ–ª—å–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è

```bash
# –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ Q8_0 –∑–∞–º—ñ—Å—Ç—å F16
VARIANT=Q8 ./start_embedding_service.sh start

# –ó–º–µ–Ω—à–∏—Ç–∏ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤
# –í—ñ–¥—Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ THREADS –≤ start_embedding_service.sh
```

## üìù –õ–æ–≥–∏ —Ç–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ —Å–µ—Ä–≤—ñ—Å—É

```bash
# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏ embedding —Å–µ—Ä–≤—ñ—Å—É
tail -f ~/models/ukr-mpnet/service.log

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ –ª–æ–≥–∏ –º–æ–¥–µ–ª–µ–π
ls ~/models/logs/
```

### –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ CPU

```bash
# –í AI –ª–∞—É–Ω—á–µ—Ä—ñ –≤–∏–±—Ä–∞—Ç–∏ –æ–ø—Ü—ñ—é 5
./ai_launcher.sh

# –ê–±–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ termux-sensor
termux-sensor -s android.sensor.cpu_temperature
```

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–°—Ç–≤–æ—Ä–∏—Ç–∏ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π**:
```bash
cd ~/ai_service
git init
git add .
git commit -m "Initial commit: AI Service with Ukrainian MPNet and Gemma"
```

2. **–î–æ–¥–∞—Ç–∏ –≤—ñ–¥–¥–∞–ª–µ–Ω–∏–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π** (GitHub/GitLab)

3. **–†–æ–∑—à–∏—Ä–∏—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª**:
   - –î–æ–¥–∞—Ç–∏ batch processing –¥–ª—è –µ–º–±–µ–¥–¥–∏–Ω–≥—ñ–≤
   - –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ vector database (ChromaDB, Pinecone)
   - Web UI –¥–ª—è –µ–º–±–µ–¥–¥–∏–Ω–≥—ñ–≤
   - RAG (Retrieval-Augmented Generation) –∑ Gemma

## üìö –î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- `AI_INTEGRATION_SUMMARY.txt` - –ü–æ–≤–Ω–∏–π –∑–≤—ñ—Ç –ø—Ä–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—é
- `SUMMARY.md` - –î–µ—Ç–∞–ª—å–Ω–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è –≤—Å—ñ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ñ–≤
- `README.md` - –û—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–∏–π README –ø—Ä–æ—î–∫—Ç—É

## üÜò –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–õ–æ–≥–∏ –ø–æ–º–∏–ª–æ–∫ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤:
- `~/models/ukr-mpnet/service.log` - Embedding service
- `~/models/logs/` - Gemma —Ç–∞ —ñ–Ω—à—ñ –º–æ–¥–µ–ª—ñ

## üìÑ –õ—ñ—Ü–µ–Ω–∑—ñ—è

–ú–æ–¥–µ–ª—ñ:
- Ukrainian MPNet: Apache 2.0
- Gemma: Gemma Terms of Use

–ö–æ–¥: MIT (—è–∫—â–æ –Ω–µ –≤–∫–∞–∑–∞–Ω–æ —ñ–Ω—à–µ)
